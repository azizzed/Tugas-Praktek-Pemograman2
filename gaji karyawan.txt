CREATE DATABASE gaji_karyawan
USE gaji_karyawan


CREATE TABLE jabatan ( kj VARCHAR (4) NOT NULL PRIMARY KEY,jabatan CHAR (50),gaji FLOAT (10,2))
CREATE TABLE pegawai ( nip VARCHAR (3) NOT NULL PRIMARY KEY , nama VARCHAR (20),kota VARCHAR (30),tgllhr date, jk VARCHAR (2),kj VARCHAR(3))
CREATE TABLE anak ( nip VARCHAR (3), nama VARCHAR (20),jk VARCHAR(2),umur NUMERIC (3))

SELECT * FROM jabatan

INSERT INTO jabatan (kj,jabatan,gaji) VALUE ('j01','marketing leader','7000000');
INSERT INTO jabatan (kj,jabatan,gaji) VALUE ('j02','system analist','6000000');
INSERT INTO jabatan (kj,jabatan,gaji) VALUE ('j03','programmer','5500000');
INSERT INTO jabatan (kj,jabatan,gaji) VALUE ('j04','network enginerr','4500000');
INSERT INTO jabatan (kj,jabatan,gaji) VALUE ('j05','database administator','5000000');
INSERT INTO jabatan (kj,jabatan,gaji) VALUE ('j06','sekretaris','3000000');

SELECT * from pegawai

INSERT INTO PEGAWAI (NIP,NAMA,KOTA,TGLLHR,JK,KJ) VALUES ('NO1','YAHYA','JAKARTA','1980-01-20','l','J02');
INSERT INTO PEGAWAI (NIP,NAMA,KOTA,TGLLHR,JK,KJ) VALUES ('NO2','BAYU','JAKARTA','1980-02-08','L','J01');
INSERT INTO PEGAWAI (NIP,NAMA,KOTA,TGLLHR,JK,KJ) VALUES ('NO3','M ZAINI DAHLAN','CIBINONG','1981-12-03','L','J03');
INSERT INTO PEGAWAI (NIP,NAMA,KOTA,TGLLHR,JK,KJ) VALUES ('NO4','AHMAD RIZAL','JAKARTA','1983-03-17','L','J03');
INSERT INTO PEGAWAI (NIP,NAMA,KOTA,TGLLHR,JK,KJ) VALUES ('NO5','MULIA','JAKARTA','1986-06-05','L','J04');
INSERT INTO PEGAWAI (NIP,NAMA,KOTA,TGLLHR,JK,KJ) VALUES ('NO6','UMI','JAKARTA','1986-01-06','P','J06');
INSERT INTO PEGAWAI (NIP,NAMA,KOTA,TGLLHR,JK,KJ) VALUES ('NO7','LUKMANUL HAKIM','DEPOK','1982-06-24','L','J03');

SELECT * FROM ANAK

INSERT INTO ANAK (NIP,NAMA,JK,UMUR) VALUES ('N02','HARIS SETIAWAN','L','10');
INSERT INTO ANAK (NIP,NAMA,JK,UMUR) VALUES ('NO2','HANNY','P','5');
INSERT INTO ANAK (NIP,NAMA,JK,UMUR) VALUES ('NO5','S HALIZAH ','P','9');
INSERT INTO ANAK (NIP,NAMA,JK,UMUR) VALUES ('NO5','M SULTAN RAISYAH ','L','1');


SELECT DISTINCT NIP AS NIP_YANG_SUDAH_PUNYA_ANAK FROM ANAK
SELECT NIP,NAMA,KOTA FROM PEGAWAI WHERE NIP='NO2'OR NIP='NO6'
SELECT*FROM JABATAN WHERE GAJI BETWEEN 3000000 AND 5000000
SELECT*FROM PEGAWAI WHERE NAMA LIKE '%ZA%'
SELECT NAMA,JABATAN FROM PEGAWAI P,JABATAN J WHERE P.KJ=J.KJ
SELECT*FROM JABATAN ORDER BY GAJI ASC LIMIT 3
SELECT*FROM JABATAN WHERE KJ IN ('J01','J02','J03')
SELECT*FROM PEGAWAI WHERE NIP IN (SELECT NIP FROM ANAK)
SELECT P.NIP,P.NAMA,COUNT(A.NIP)AS JUMLAH_ANAK FROM PEGAWAI P,ANAK A WHERE P.NIP=A.NIP GROUP BY P.NIP,P.NAMA

SELECT J.JABATAN,COUNT(P.NIP)AS JUMLAH_PEGAWAI,SUM(GAJI)AS TOTAL_GAJI_YANG_DIKELUARKAN FROM PEGAWAI P,JABATAN J WHERE P.KJ=J.KJ GROUP BY J.GAJI,J.JABATAN
SELECT J.JABATAN,COUNT(P.NIP)AS JUMLAH_PEGAWAI,SUM(J.GAJI)AS TOTAL_GAJI_YANG_DIKELUARKAN FROM PEGAWAI P,JABATAN J WHERE P.KJ=J.KJ GROUP BY J.GAJI,J.JABATAN HAVING SUM(J.GAJI)>5000000



-- JAWABAN NO 1 (  3 JABATAN DENGAN GAJI PALING BESAR )
SELECT*FROM JABATAN WHERE GAJI BETWEEN 5500000 AND 7000000

-- JAWABAN NO 2 ( KARYAWAN YANG TIDAK MEMPUNYAI ANAK  )
SELECT*FROM pegawai WHERE nip NOT IN ( SELECT nip FROM anak )

-- JAWABAN NO 3 ( TOTAL JUMLAH PEGAWAI  )
SELECT J.JABATAN,COUNT(P.NIP)AS JUMLAH_PEGAWAI FROM PEGAWAI P,JABATAN J WHERE P.KJ=J.KJ GROUP BY J.GAJI,J.JABATAN

-- JAWABAN NO 4 ( TOTAL GAJI KARYAWAN  )
SELECT COUNT(P.NIP)AS TOTAL_JUMLAH_KARYAWAN, SUM(GAJI) AS TOTAL_GAJI_KARYAWAN FROM PEGAWAI P,JABATAN J WHERE P.KJ=J.KJ GROUP BY J.GAJI,J.JABATAN

-- JAWABAN NO 5 ( TOTAL PEGAWAI YANG DENGAN JABATAN PROGRAMMER )
SELECT*FROM pegawai WHERE KJ IN ('J03')

-- JAWABAN NO 6 ( RATA-RATA GAJI PEGAWAI )
SELECT AVG (GAJI) AS RATA2_GAJI_PEGAWAI FROM PEGAWAI P,JABATAN J WHERE P.KJ=J.KJ

-- JAWABAN NO 7 ( ANAK DENGAN DARI PEGAWAI YANG USIANYA PALING MUDA )
SELECT NAMA AS ANAK_USIA_PALING_MUDA, MIN(UMUR) AS USIA FROM ANAK GROUP BY UMUR LIMIT 1

SELECT P.NIP, P. NAMA, COUNT(A.NIP) AS JUMLAH_ANAK FROM pegawai P INNER JOIN anak A ON P.NIP = A.NIP GROUP BY P.NIP, P.NAMA


SELECT P.NIP, P. NAMA, COUNT(A.NIP) AS JUMLAH_ANAK FROM pegawai P LEFT JOIN anak A ON P.NIP = A.NIP GROUP BY P.NIP, P.NAMA

SELECT P.NIP, P. NAMA, COUNT(A.NIP) AS JUMLAH_ANAK FROM pegawai P RIGHT JOIN anak A ON P.NIP = A.NIP GROUP BY P.NIP, P.NAMA

SELECT P.NAMA, J.JABATAN, CASE J.KJ









